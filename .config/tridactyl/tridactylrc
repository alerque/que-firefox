sanitise tridactyllocal tridactylsync

guiset_quiet tabstoolbar none
guiset_quiet tabs always
guiset_quiet navbar autohide
guiset_quiet hoverlink left
guiset_quiet statuspanel right

colorscheme shydactyl

bind j scrollline 1
bind k scrollline -1
bind J scrollline 15
bind K scrollline -15

unbind A

bind m open javascript:if(document.getSelection){s=document.getSelection();}else{s='';};document.location='https://pinboard.in/add?next=same&url='+encodeURIComponent(location.href)+'&description='+encodeURIComponent(s)+'&title='+encodeURIComponent(document.title)

" " Comment toggler for Reddit and Hacker News
" bind ;c hint -c [class*="expand"],[class="togg"]

" GitHub pull request checkout command to clipboard (only works if you're a collaborator or above)
bind yp composite js document.getElementById("clone-help-step-1").textContent.replace("git checkout -b", "git checkout -B").replace("git pull ", "git fetch ") + "git reset --hard " + document.getElementById("clone-help-step-1").textContent.split(" ")[3].replace("-","/") | yank

" Git{Hub,Lab} git clone via SSH yank
bind yg composite js "git clone " + document.location.href.replace(/https?:\/\//,"git@").replace("/",":").replace(/$/,".git") | clipboard yank

" " As above but execute it and open terminal in folder
" bind ,g js let uri = document.location.href.replace(/https?:\/\//,"git@").replace("/",":").replace(/$/,".git"); tri.native.run("cd ~/projects; git clone " + uri + "; cd \"$(basename \"" + uri + "\" .git)\"; st")

" " I like wikiwand but I don't like the way it changes URLs
" bindurl wikiwand.com yy composite js document.location.href.replace("wikiwand.com/en","wikipedia.org/wiki") | clipboard yank

" " Make gu take you back to subreddit from comments
" bindurl reddit.com gu urlparent 4

" Only hint search results on Google and DDG
bindurl www.google.com f hint -Jc .rc > .r > a
bindurl www.google.com F hint -Jbc .rc>.r>a
bindurl ^https://duckduckgo.com f hint -Jc [class=result__a]
bindurl ^https://duckduckgo.com F hint -Jbc [class=result__a]

" " Allow Ctrl-a to select all in the commandline
" unbind --mode=ex <C-a>

" " Allow Ctrl-c to copy in the commandline
" unbind --mode=ex <C-c>

" " Handy multiwindow/multitasking binds
" bind gd tabdetach
" bind gD composite tabduplicate | tabdetach

" Make yy use canonical / short links on the 5 websites that support them
bind yy clipboard yankshort

" " Stupid workaround to let hint -; be used with composite which steals semi-colons
" command hint_focus hint -;

" " Open right click menu on links
" bind ;C composite hint_focus; !s xdotool key Menu

" "
" " Misc settings
" "

" " set editorcmd to suckless terminal, or use the defaults on other platforms
" js tri.browserBg.runtime.getPlatformInfo().then(os=>{const editorcmd = os.os=="linux" ? "st vim" : "auto"; tri.config.set("editorcmd", editorcmd)})

" Sane hinting mode
" set hintfiltermode vimperator
" set hintnames numeric

" " Defaults to 300ms but I'm a 'move fast and close the wrong tabs' kinda chap
" set hintdelay 100

" Add helper commands that Mozillians think make Firefox irredeemably
" insecure. For details, read the comment at the top of this file.
command myfixamo jsb tri.excmds.setpref("privacy.resistFingerprinting.block_mozAddonManager", "true").then(tri.excmds.setpref("extensions.webextensions.restrictedDomains", '""'))

" Make Tridactyl work on more sites at the expense of some security. For
" details, read the comment at the top of this file.
myfixamo

" " Make quickmarks for the sane Tridactyl issue view
" quickmark t https://github.com/tridactyl/tridactyl/issues?utf8=%E2%9C%93&q=sort%3Aupdated-desc+

" "
" " URL redirects
" "

" " New reddit is bad
" autocmd DocStart ^http(s?)://www.reddit.com js tri.excmds.urlmodify("-t", "www", "old")

autocmd DocStart ^http(s?)://www.amazon.com js tri.excmds.urlmodify("-t", "www", "smile")

" This will have to do until someone writes us a nice syntax file :)
" vim: set filetype=vim:
